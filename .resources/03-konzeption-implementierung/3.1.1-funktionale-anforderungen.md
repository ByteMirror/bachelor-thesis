# 3.1.1 Funktionale Anforderungen

**Datum**: 2025-01-24
**Status**: Planung abgeschlossen
**Ziel-Seitenzahl**: 1.5-2.0 Seiten

---

## <¯ Kontext und Kernbotschaft

**Kernbotschaft**: Atlas VTT muss als Obsidian-Plugin die essentiellen Funktionen eines Virtual Tabletops bereitstellen, wobei die spezifischen Anforderungen durch D&D 5e Standards, bestehende VTT-Lösungen (Foundry VTT, Roll20) und die Obsidian-Plattform definiert werden.

**Wissenschaftliche Herangehensweise**:
- Ableitung der Anforderungen aus bestehenden VTT-Standards
- Analyse von D&D 5e Mechaniken (Grid-Größe: 5 Fuß = 1 Quadrat)
- Berücksichtigung von Obsidian-spezifischen Constraints (Single-Bundle, Plugin API)
- Kategorisierung nach Priorität (MVP vs. P1 Features)

---

## =Ý Inhaltliche Struktur

### 1. Einleitung: VTT-Funktionen im Kontext von Tabletop-RPGs (0.3 Seiten)

**Argumentation**:
- Virtual Tabletops digitalisieren klassisches Tabletop-RPG-Gameplay
- Kernfunktionen basieren auf D&D 5e Combat-Regeln (Grid-based Movement, Initiative, Measurements)
- Atlas VTT fokussiert auf lokales Gameplay innerhalb Obsidian (im Gegensatz zu cloud-basierten Lösungen)

**Quellen**:
- D&D 5e Player's Handbook (Grid Mechanics)
- Foundry VTT Feature Documentation
- Roll20 Feature Comparison

---

### 2. Karten-Management (0.4 Seiten)

**Anforderungen**:

| ID | Anforderung | Priorität | Begründung |
|----|-------------|-----------|------------|
| F1.1 | Laden von Hintergrundkarten (JPEG, PNG, WebP) | P0 | Essentiell für jede VTT-Session |
| F1.2 | Grid-Overlay (Square, Hexagonal) | P0 | D&D 5e verwendet Grid-basiertes Movement |
| F1.3 | Grid-Konfiguration (Größe, Offset, Typ) | P0 | Maps haben unterschiedliche Skalierungen |
| F1.4 | Speicherung als `.atlasmap` Dateiformat | P0 | Persistenz für Session-Continuity |
| F1.5 | Multi-Scene-Support | P1 | Wechsel zwischen Locations |

**D&D 5e Standard**:
- 1 Square = 5 Fuß reale Distanz
- Standard Token Size = 1×1 für Medium Creatures
- Grid-Alignment für taktisches Movement

**Code-Referenzen**:
- `src/app/MapLoader.ts` - Map-Loading-Logik
- `src/app/grid/` - Grid-System-Implementierung

---

### 3. Token-System (0.4 Seiten)

**Anforderungen**:

| ID | Anforderung | Priorität | Begründung |
|----|-------------|-----------|------------|
| F2.1 | Token Creation & Placement | P0 | Repräsentation von Characters & NPCs |
| F2.2 | Drag & Drop Movement | P0 | Grundlegende Interaktion |
| F2.3 | Grid-Snapping | P0 | Alignment mit D&D 5e Movement Rules |
| F2.4 | Token Rotation | P0 | Facing für Combat Mechanics |
| F2.5 | Token Selection (Single & Multi) | P0 | Gruppenbewegung |
| F2.6 | Health Bar Display | P1 | Visual HP Tracking |
| F2.7 | Status Icons | P1 | Conditions (Prone, Stunned, etc.) |
| F2.8 | Token-Statblock Linking | P1 | Integration mit Character Sheets |

**Industry Standards**:
- Foundry VTT: Drag & Drop, Multi-Selection, Vision Layers
- Roll20: Grid Snapping, Token Rotation, Status Markers

**Code-Referenzen**:
- `src/app/pixi/token-renderer/` - Token-Rendering
- `src/app/objects/MapObject.ts` - Domain Model

---

### 4. Fog of War (0.3 Seiten)

**Anforderungen**:

| ID | Anforderung | Priorität | Begründung |
|----|-------------|-----------|------------|
| F3.1 | Fog Region Creation (Rectangle, Polygon) | P0 | Verbergen nicht-entdeckter Bereiche |
| F3.2 | Fog Removal/Reveal | P0 | Progressives Entdecken der Map |
| F3.3 | GM-Only Preview (GM sieht full map) | P0 | GM muss Fog planen können |
| F3.4 | Player View (Fog opaque) | P0 | Separates Rendering für Players |

**VTT-Standard**:
- Foundry VTT: Dynamic Lighting + Fog of War
- Roll20: Static Fog with Manual Reveal

---

### 5. Werkzeuge und Interaktion (0.3 Seiten)

**Anforderungen**:

| ID | Anforderung | Priorität | Begründung |
|----|-------------|-----------|------------|
| F4.1 | Measure Tool (Distance Measurement) | P0 | D&D 5e Movement & Spell Range |
| F4.2 | Drawing Tools (Freehand, Shapes) | P1 | Tactical Planning |
| F4.3 | Note Pins (Link zu Obsidian Notes) | P1 | Integration mit Vault Knowledge |
| F4.4 | Text Placement | P1 | Annotations |

**D&D 5e Relevanz**:
- Spell Ranges: 5 ft, 10 ft, 30 ft, 60 ft, 120 ft
- Movement Speed: 30 ft (6 Squares) standard

---

### 6. Character Management (0.2 Seiten)

**Anforderungen**:

| ID | Anforderung | Priorität | Begründung |
|----|-------------|-----------|------------|
| F5.1 | Statblock Builder (D&D 5e) | P1 | Character Sheet Creation |
| F5.2 | Statblock-Token Linking | P1 | Click Token ’ View Stats |
| F5.3 | Statblock Storage (Markdown Files) | P1 | Vault-native Storage |

**Obsidian Integration**:
- Statblocks als Markdown-Dateien im Vault
- YAML Frontmatter für strukturierte Daten
- Bidirektionale Links Token ” Note

---

### 7. Multiplayer (Optional) (0.1 Seiten)

**Anforderungen**:

| ID | Anforderung | Priorität | Begründung |
|----|-------------|-----------|------------|
| F6.1 | WebSocket-based Multiplayer | Experimental | Online Sessions |
| F6.2 | Real-time Dice Roll Broadcasting | Experimental | Shared Dice Rolling |
| F6.3 | Room-based Sessions | Experimental | No Account Required |

**Hinweis**: PartyKit-basierte experimentelle Funktion, nicht Teil der Kern-Evaluation.

---

## =Ú Literatur und Quellen

### Externe Quellen (zu recherchieren)

#### D&D 5e Regelwerk
- [ ] **Player's Handbook** - Combat Rules, Movement, Grid Mechanics
- [ ] **Dungeon Master's Guide** - Encounter Design, Map Scales

#### VTT Industry Standards
- [ ] **Foundry VTT** - Feature Documentation, Token System, Fog of War
- [ ] **Roll20 Wiki** - VTT Features, Grid System
- [ ] **Owlbear Rodeo** - Lightweight VTT Approach (Vergleich)

#### Obsidian Platform
- [ ] **Obsidian API Documentation** - Plugin Constraints, File Handling
- [ ] **Obsidian Community Plugins** - Best Practices

### Interne Quellen

- `project_purpose_and_architecture.md` - High-Level Goals
- `tech_stack_and_dependencies.md` - Technical Constraints
- `road-map.md` - MVP Checklist, Feature Priorities

---

## =¡ Schreibnotizen

### Stil
- Deutsch (außer Fachbegriffe: Token, Grid, Fog of War)
- Tabellenformat für Anforderungen (übersichtlich)
- Kategorisierung nach Feature-Bereichen
- Prioritäten explizit angeben (P0 = MVP, P1 = Nice-to-Have)

### Wissenschaftlich
- Anforderungen aus bestehenden Standards ableiten (nicht erfinden)
- D&D 5e als Referenz für Game Mechanics
- Foundry VTT/Roll20 als Industry Benchmarks
- Obsidian-Constraints als technische Limitierungen

### Zu vermeiden
- L Reine Feature-Liste ohne Begründung
- L Subjektive Wünsche ("Es wäre cool wenn...")
- L Zu detaillierte Code-Beschreibung (das kommt in 3.3)

### Zu betonen
-  Ableitung aus D&D 5e Standards (wissenschaftlich fundiert)
-  Vergleich mit bestehenden VTT-Lösungen
-  Priorisierung nach MVP-Kriterien
-  Obsidian-spezifische Integration (Note Pins, Markdown Statblocks)

---

## = Verbindungen zu anderen Kapiteln

### Vorwärts-Verweise
- **3.2 Systemdesign** - Wie diese Anforderungen architektonisch umgesetzt werden
- **3.3 Lösungsansätze** - Implementierung der priorisierten Features
- **4. Evaluation** - Validation, dass Anforderungen erfüllt wurden

### Rückwärts-Verweise
- **2.2.1 Virtual Tabletop Tools** - Kontext: Was ist ein VTT?
- **2.1.1 Obsidian** - Platform Constraints

---

##  TODO beim Schreiben

### Research-Phase
- [ ] D&D 5e Player's Handbook: Grid Rules recherchieren (exakte Zitate)
- [ ] Foundry VTT Docs: Token System & Fog of War Features
- [ ] Roll20 Feature Comparison durchgehen
- [ ] Obsidian API Docs: File Handling & Plugin Constraints

### Schreib-Phase
- [ ] Einleitung: VTT-Kontext etablieren
- [ ] Tabellen für Anforderungen erstellen (F1.X-Format)
- [ ] D&D 5e Standards zitieren (Grid: 5 ft = 1 Square)
- [ ] Code-Referenzen einfügen (datei.ts:zeile Format)
- [ ] BibTeX-Einträge parallel erstellen

### Review-Phase
- [ ] Alle Anforderungen haben Priorität (P0/P1)
- [ ] Alle Anforderungen haben Begründung
- [ ] D&D 5e Referenzen korrekt zitiert
- [ ] Code-Referenzen valide

---

## <¯ Kernaussagen für LaTeX

### Zitierbare Statements

1. **VTT-Definition**:
   > "Virtual Tabletops digitalisieren klassisches Tabletop-RPG-Gameplay durch interaktive Karten, Token-basiertes Movement und Fog of War."

2. **D&D 5e Grid Standard**:
   > "D&D 5e definiert ein Grid-basiertes Movement-System, wobei ein Quadrat 5 Fuß realer Distanz entspricht [PHB S.192]."

3. **Foundry VTT als Benchmark**:
   > "Foundry VTT etabliert den Industry Standard für VTT-Features wie Drag & Drop Token Movement, Dynamic Lighting und Multi-Layer Rendering [FoundryDocs2024]."

4. **Obsidian-spezifische Integration**:
   > "Atlas VTT nutzt Obsidians Vault-Struktur für Statblock-Storage und ermöglicht bidirektionale Links zwischen Tokens und Markdown-Dateien."

5. **Priorisierung**:
   > "Die Anforderungen wurden nach MVP-Kriterien priorisiert (P0), wobei Karten-Management, Token-System und Fog of War als essentiell identifiziert wurden."

---

**Letzte Aktualisierung**: 2025-01-24
**Nächster Schritt**: Research durchführen, dann LaTeX-Text schreiben
